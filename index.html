<script src="js/libraries/jquery-2.1.1.js" type="text/javascript"></script>
<script src="js/libraries/jquery-cookie/jquery.cookie.js" type="text/javascript"></script>
<script src="js/Templates.js" type="text/javascript"></script>
<script>
    window.onload = function () {
        checkLanguage();
        if(isAuthorized()) {
            document.location.href = '/grammar/rules';
        }
        selectLang($.cookie('language'));
        scaling();
    };

    window.onresize = function () {
        scaling();
    };

    function scaling(){
        var index = Math.ceil(innerWidth*innerHeight/50000)-10;
        var fontSize = 100 + Math.ceil(index * 3);
        document.getElementById("func1").style.fontSize = fontSize+"%";
        document.getElementById("func2").style.fontSize = fontSize+"%";
        document.getElementById("func3").style.fontSize = fontSize+"%";
        document.getElementById("func4").style.fontSize = fontSize+"%";
        document.getElementById("func5").style.fontSize = fontSize+"%";
        document.getElementById("func6").style.fontSize = fontSize+"%";
        document.getElementById("func7").style.fontSize = fontSize+"%";
        var imageSize = 50 + index * 3;
        document.getElementById("funcImage1").style.height = imageSize;
        document.getElementById("funcImage2").style.height = imageSize;
        document.getElementById("funcImage3").style.height = imageSize;
        document.getElementById("funcImage4").style.height = imageSize;
        document.getElementById("funcImage5").style.height = imageSize;
        document.getElementById("funcImage6").style.height = imageSize;
        document.getElementById("funcImage7").style.height = imageSize;
        var flagSize = 40 + index * 2;
        document.getElementById("langImage0").style.height = flagSize;
        document.getElementById("langImage1").style.height = flagSize;
        document.getElementById("logo-image").style.height = 50 + index * 3;
        document.getElementById("welcome-text").style.fontSize = 18 + index;
        document.getElementById("welcome-text2").style.fontSize = 16 + index;
        document.getElementById("sign-form").style.width = 225 + index * 10;
        var signHeader = 20 + index;
        document.getElementById("header-in").style.fontSize = signHeader;
        document.getElementById("header-up").style.fontSize = signHeader;
        var signInput = 14 + index;
        document.getElementById("email").style.fontSize = signInput;
        document.getElementById("password").style.fontSize = signInput;
        document.getElementById("name").style.fontSize = signInput;
        var signInputHeight = 24 + index * 2;
        document.getElementById("email").style.height = signInputHeight;
        document.getElementById("password").style.height = signInputHeight;
        document.getElementById("name").style.height = signInputHeight;
        var signButton = 15 + index;
        document.getElementById("button-in").style.fontSize = signButton;
        document.getElementById("button-up").style.fontSize = signButton;
        var signText = 14 + Math.ceil(index * 0.5);
        document.getElementById("text-in").style.fontSize = signText;
        document.getElementById("text-up").style.fontSize = signText;
        document.getElementById("text-in2").style.fontSize = signText;
        document.getElementById("text-up2").style.fontSize = signText;
        document.getElementById("error-msg").style.fontSize = signText;
    }

    function selectLang(lang){
        $.cookie('language',lang,{path:'/'});
        document.getElementById("welcome-text").innerHTML = landing[lang]['welcome-text'];
        document.getElementById("welcome-text2").innerHTML = landing[lang]['welcome-text2'];
        document.getElementById("grammar-header").innerHTML = landing[lang]['landing-grammar-header'];
        document.getElementById("grammar-text").innerHTML = landing[lang]['landing-grammar-text'];
        document.getElementById("vocabulary-header").innerHTML = landing[lang]['landing-vocabulary-header'];
        document.getElementById("vocabulary-text").innerHTML = landing[lang]['landing-vocabulary-text'];
        document.getElementById("exercises-header").innerHTML = landing[lang]['landing-exercises-header'];
        document.getElementById("exercises-text").innerHTML = landing[lang]['landing-exercises-text'];
        document.getElementById("testing-header").innerHTML = landing[lang]['landing-testing-header'];
        document.getElementById("testing-text").innerHTML = landing[lang]['landing-testing-text'];
        document.getElementById("chatting-header").innerHTML = landing[lang]['landing-chatting-header'];
        document.getElementById("chatting-text").innerHTML = landing[lang]['landing-chatting-text'];
        document.getElementById("library-header").innerHTML = landing[lang]['landing-library-header'];
        document.getElementById("library-text").innerHTML = landing[lang]['landing-library-text'];
        document.getElementById("advices-header").innerHTML = landing[lang]['landing-advices-header'];
        document.getElementById("advices-text").innerHTML = landing[lang]['landing-advices-text'];
        document.getElementById("header-up").innerHTML = landing[lang]['sign-up-header'];
        document.getElementById("header-in").innerHTML = landing[lang]['sign-in-header'];
        document.getElementById("button-up").value = landing[lang]['sign-up-button'];
        document.getElementById("button-in").value = landing[lang]['sign-in-button'];
        document.getElementById("text-up").innerHTML = landing[lang]['sign-up-text'];
        document.getElementById("text-in").innerHTML = landing[lang]['sign-in-text'];
        document.getElementById("text-up2").innerHTML = landing[lang]['sign-up-text2'];
        document.getElementById("text-in2").innerHTML = landing[lang]['sign-in-text2'];
        document.getElementById("password").placeholder = landing[lang]['reg-form-password'];
        document.getElementById("name").placeholder = landing[lang]['reg-form-name'];
        scaling();
    }

    function signInUp(choice) {
        if (choice == 1) {
            document.getElementById("header-up").style.display = "none";
            document.getElementById("header-in").style.display = "block";
            document.getElementById("name").style.display = "none";
            document.getElementById("buttons-up").style.display = "none";
            document.getElementById("buttons-in").style.display = "block";
        } else {
            document.getElementById("header-up").style.display = "block";
            document.getElementById("header-in").style.display = "none";
            document.getElementById("name").style.display = "block";
            document.getElementById("buttons-up").style.display = "block";
            document.getElementById("buttons-in").style.display = "none";
        }
    }

    function register(){
        document.getElementById("error-msg").innerText = '';
        var errorMessage = '';
        $.ajax({
            type: "POST",
            url: "../ajax/auth-reg/canBeRegistred.php",
            data: "email=" + document.getElementById("email").value,
            success: function (data) {
                if (data != 0) {
                    errorMessage += landing[$.cookie('language')]['error-same-email'] + '\n';
                }
                if (document.getElementById("email").value == '') {
                    errorMessage += landing[$.cookie('language')]['error-empty-email'] + '\n';
                }
                if (document.getElementById("name").value == '') {
                    errorMessage += landing[$.cookie('language')]['error-empty-name'] + '\n';
                }
                if (document.getElementById("password").value == '') {
                    errorMessage += landing[$.cookie('language')]['error-empty-pass'] + '\n';
                }
                if(errorMessage != '') {
                    document.getElementById("error-msg").innerText = errorMessage;
                } else {
                    $.ajax({
                        type: "POST",
                        url: "../ajax/auth-reg/registerUser.php",
                        data: "email=" + document.getElementById("email").value +
                        "&name=" + document.getElementById("name").value +
                        "&password=" + document.getElementById("password").value,
                        success: function (data) {
                            $.cookie("user",data,{path:'/'});
                            document.location.href = '/grammar/rules';
                        }
                    });
                }
            }
        });
    }

    function authorize(){
        document.getElementById("error-msg").innerText = '';
        var errorMessage = '';
        $.ajax({
            type: "POST",
            url: "../ajax/auth-reg/canBeAuthorized.php",
            data: "email=" + document.getElementById("email").value + "&password=" + document.getElementById("password").value,
            success: function (data) {
                if (data == -1) {
                    errorMessage += landing[$.cookie('language')]['error-no-user'] + '\n';
                }
                if (document.getElementById("email").value == '') {
                    errorMessage += landing[$.cookie('language')]['error-empty-email'] + '\n';
                }
                if (document.getElementById("password").value == '') {
                    errorMessage += landing[$.cookie('language')]['error-empty-pass'] + '\n';
                }
                if(errorMessage != '') {
                    document.getElementById("error-msg").innerText = errorMessage;
                } else {
                    $.cookie("user",data,{path:'/'});
                    document.location.href = '/grammar/rules';
                }
            }
        });
    }
</script>
<html>
<head>
    <title>Your English Friend</title>
    <link rel="shortcut icon" href="images/icon.png" type="image/png">
    <link rel="stylesheet" type="text/css" href="css/landing.css"/>
</head>
<body class="body">
<div class="header">
    <table class="header-table">
        <tr>
            <td class="header-cell"></td>
            <td align="center">
                <a class="header-text"><img src="images/logo.png" id="logo-image" height="60"></a>
            </td>
            <td class="header-cell">
                <div class="div-lang">
                    <table>
                        <tr>
                            <td>
                                <a onclick="selectLang(0)"><img src="images/lang/en.png" id="langImage0" class="image-flag"></a>
                            </td>
                            <td>
                                <a onclick="selectLang(1)"><img src="images/lang/ru.png" id="langImage1" class="image-flag"></a>
                            </td>
                        </tr>
                    </table>
                </div>
            </td>
        </tr>
    </table>
</div>
<table class="table">
    <tr>
        <td align="center" class="cell">
            <p class="welcome-text-big" id="welcome-text">Подружитесь с <b>Your English Friend</b>!<br>
                            И он поможет Вам выучить английский язык быстро и интересно!</p>
        </td>
        <td rowspan="3">
            <div class="div-sign" id="sign-form" align="left">
                <p class="sign-header" id="header-up">Регистрация</p>
                <p class="sign-header hidden" id="header-in">Вход</p>
                <p class="error-msg" id="error-msg"></p>
                <input class="input" type="email" placeholder="Email" autofocus="true" id="email"><br>
                <input class="input" placeholder="Имя" autofocus="true" id="name">
                <input class="input" type="password" placeholder="Пароль" id="password"><br>
                <div class="div-sign-buttons" id="buttons-up">
                    <input type="button" class="action" value="Регистрация" id="button-up" onclick="register()">
                    <a class="sign-text" id="text-up" onclick="signInUp(1)">Вход</a><br>
                    <a class="sign-text" id="text-up2" onclick="document.location.href = '/grammar/rules';">Предпросмотр</a>
                </div>
                <div class="div-sign-buttons hidden" id="buttons-in">
                    <input type="button" class="action" value="Вход" id="button-in" onclick="authorize()">
                    <a class="sign-text" id="text-in" onclick="signInUp(2)">Регистрация</a><br>
                    <a class="sign-text" id="text-in2">Забыли пароль?</a>
                </div>
            </div>
        </td>
    </tr>
    <tr>
        <td align="center">
            <table class="functions-table">
                <tr>
                    <td align="center">
                        <div class="function-div">
                            <table class="function-table" id="func1" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/grammar.jpg" id="funcImage1" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="grammar-header">Грамматика</a><br>
                                        <a class="function-text" id="grammar-text">Просто и понятно изложенные правила грамматики</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="function-div">
                            <table class="function-table" id="func2" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/vocabulary.jpg" id="funcImage2" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="vocabulary-header">Лексика</a><br>
                                        <a class="function-text" id="vocabulary-text">Подборки слов для общения на разные темы</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                    <td align="center">
                        <div class="function-div">
                            <table class="function-table" id="func3" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/exercises.jpg" id="funcImage3" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="exercises-header">Упражнения</a><br>
                                        <a class="function-text" id="exercises-text">Закрепление правил грамматики упражнениями</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="function-div">
                            <table class="function-table" id="func4" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/testing.jpg" id="funcImage4" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="testing-header">Тестирование</a><br>
                                        <a class="function-text" id="testing-text">7 видов тестов для быстрого изучения слов</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="function-div">
                            <table class="function-table" id="func5" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/chatting.jpg" id="funcImage5" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="chatting-header">Общение</a><br>
                                        <a class="function-text" id="chatting-text">Общение на английском с друзьями и новыми знакомыми</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                    <td align="center">
                        <div class="function-div">
                            <table class="function-table" id="func6" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/library.jpg" id="funcImage6" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="library-header">Библиотека</a><br>
                                        <a class="function-text" id="library-text">Большой сборник текстовых, аудио и видео материалов</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="function-div">
                            <table class="function-table" id="func7" style="font-size: 100%">
                                <tr>
                                    <td class="function-cell">
                                        <a><img src="images/landing/advices.jpg" id="funcImage7" class="function-image"></a>
                                    </td>
                                    <td>
                                        <a class="function-header" id="advices-header">Полезные советы</a><br>
                                        <a class="function-text" id="advices-text">Полезные статьи по изучению английского языка</a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td class="cell">
            <p class="welcome-text" id="welcome-text2">Пройдите <b>БЕСПЛАТНУЮ</b> регистрацию<br>
                и начинайте учить английский язык прямо сейчас!</p>
        </td>
    </tr>
</table>
</body>
</html>